<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Lab 11 Demo 1 - JSON and Local Storage</title>
</head>
<body>
    <h1>Store and retrieve data from local storage.</h1>
    <a href="https://www.w3schools.com/js/js_json_intro.asp">https://www.w3schools.com/js/js_json_intro.asp</a><br />
    <a href="https://www.w3schools.com/js/tryit.asp?filename=tryjson_store">https://www.w3schools.com/js/tryit.asp?filename=tryjson_store</a><br />
    <a href="https://www.w3schools.com/html/html5_webstorage.asp">https://www.w3schools.com/html/html5_webstorage.asp</a><br />

    <h3>Starting with an object:</h3>
    <p id="demo1"></p>
    <br />
    <h3>Can be stringified as:</h3>
    <p id="demo2"></p>
    <br />
    <h3>Starting with a stringified object:</h3>
    <p id="demo3"></p>
    <br />
    <h3>Starting with a array of objects:</h3>
    <p id="demo4"></p>
    <br />
    <h3>Output the stringified array of objects:</h3>
    <p id="demo5"></p>
    <br />
    <h3>Parse the stringified array of objects and display one property of one element:</h3>
    <p id="demo6"></p>
    <br />
    <h3>Stringify, store and retrieve an object to/from loacalStorage:</h3>
    <p id="demo7"></p>
    <br />


    <script>
        var myOBJ, myJSON, myARR, text, obj;

        // demo 1: start with a JavaScript object ...
        myOBJ = { name: "John", age: 31, city: "New York" };

        // Use the object by it's properties
        document.getElementById("demo1").innerHTML = "name= " + myOBJ.name +
            " age= " + myOBJ.age +
            " city= " + myOBJ.city;

        // demo 2: now "stringify" (serialize) the object and display the result
        myJSON = JSON.stringify(myOBJ); // returns a string representation of the object
        document.getElementById("demo2").innerHTML = myJSON;

        // demo 3: work "backwards" - start with a JSON string
        // then convert this into an object and display the result
        myJSON = '{ "name": "John", "age": 31, "city": "New York" }'; // note that single ' enclose "escape" double "
        // Alternate: use escape char \
        myJSON = "{ \"name\": \"John\", \"age\": 31, \"city\": \"New York\" }";

        // now convert this JSON string into an object:
        myOBJ = JSON.parse(myJSON);

        // Again, let's output the object by its properties
        document.getElementById("demo3").innerHTML = "name= " + myOBJ.name +
            " age= " + myOBJ.age +
            " city= " + myOBJ.city;

        // we can also stringify arrays:
        // create an array of 3 objects
        myARR = [
            { name: "John", age: 31, city: "New York" },
            { name: "wendy", age: 24, city: "Toronto" },
            { name: "Bob", age: 22, city: "Vancouver" }
        ];

        // demo4 - output the array (notice this is not a practical/valid way to display array contents)
        document.getElementById("demo4").innerHTML = myARR;

        // demo 5 - stringify the array and display it
        myJSON = JSON.stringify(myARR);
        document.getElementById("demo5").innerHTML = myJSON;

        // demo 6 - reverse the JSON and display it
        myARR = JSON.parse(myJSON);
        document.getElementById("demo6").innerHTML = "2nd element: name=" + myARR[1].name + " city=" + myARR[1].city;

        // demo 7 - localStorage: start with an object, stringify it and store it as text in the browser
        myOBJ = { name: "Susan", age: 31, city: "Moose Jaw" };
        myJSON = JSON.stringify(myOBJ);

        // now store this string: using localStorage.setItem("KeyName", ""DATA")
        localStorage.setItem("SusanOBJ", myJSON);

        // now retrieve the item from loacalStorage and display it
        text = localStorage.getItem("SusanOBJ"); // return the string stored under the key "SusanOBJ"

        // parse this text into an object
        myOBJ = JSON.parse(text);

        // and output it
        document.getElementById("demo7").innerHTML = "name= " + myOBJ.name +
            " age= " + myOBJ.age +
            " city= " + myOBJ.city;

        // to delete all the stored data for this website
        // localStorage.clear();

    </script>
</body>
</html>